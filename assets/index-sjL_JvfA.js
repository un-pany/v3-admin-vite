import"./index-pmkFKrkJ.js";/* empty css                  *//* empty css               *//* empty css                 */import{g as P,d as E}from"./el-message-box-D46NQ6zc.js";/* empty css                 *//* empty css                   */import{a3 as R,ad as S,E as D,r as U,n as B}from"./element-D6yGaeVA.js";import{t as F,A as $,P as r,G as a,B as w,u,$ as _,aF as C,a8 as y,n as I,L as d,M as T,y as V}from"./vue-CiNTPoLB.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vxe-DbfZp5nQ.js";const O={class:"app-container"},q=F({name:"VxeTable",__name:"index",setup(A){const l=C("xGridDom"),b=_({loading:!0,autoResize:!0,pagerConfig:{align:"right"},formConfig:{items:[{field:"username",itemRender:{name:"VxeInput",props:{placeholder:"用户名",clearable:!0}}},{field:"phone",itemRender:{name:"VxeInput",props:{placeholder:"手机号",clearable:!0}}},{itemRender:{name:"VxeButtonGroup",options:[{type:"submit",content:"查询",status:"primary",icon:"vxe-icon-search"},{type:"reset",content:"重置",icon:"vxe-icon-refresh"}]}}]},toolbarConfig:{refresh:!0,custom:!0,slots:{buttons:"toolbar-btns"}},customConfig:{checkMethod:({column:e})=>!["username"].includes(e.field)},columns:[{type:"checkbox",width:"50px"},{field:"username",title:"用户名"},{field:"roles",title:"角色",slots:{default:"role-column"}},{field:"phone",title:"手机号"},{field:"email",title:"邮箱"},{field:"status",title:"状态",slots:{default:"status-column"}},{field:"createTime",title:"创建时间"},{title:"操作",width:"150px",fixed:"right",showOverflow:!1,slots:{default:"row-operate"}}],proxyConfig:{seq:!0,form:!0,autoLoad:!0,props:{total:"total"},ajax:{query:({page:e,form:t})=>(b.loading=!0,o.clearTable(),new Promise(c=>{let m=0,f=[];const g=x=>{x?.data&&(m=x.data.total,f=x.data.list),b.loading=!1,c({total:m,result:f})},k={username:t.username||"",phone:t.phone||"",size:e.pageSize,currentPage:e.currentPage};P(k).then(g).catch(g)}))}}}),v=C("xModalDom"),h=_({title:"",showClose:!0,escClosable:!0,maskClosable:!0,beforeHideMethod:()=>(p.value?.clearValidate(),Promise.resolve())}),p=C("xFormDom"),i=_({span:24,titleWidth:"100px",loading:!1,titleColon:!1,data:{username:"",password:""},items:[{field:"username",title:"用户名",itemRender:{name:"$input",props:{placeholder:"请输入"}}},{field:"password",title:"密码",itemRender:{name:"$input",props:{placeholder:"请输入"}}},{align:"right",itemRender:{name:"$buttons",children:[{props:{content:"取消"},events:{click:()=>v.value?.close()}},{props:{type:"submit",content:"确定",status:"primary"},events:{click:()=>o.onSubmitForm()}}]}}],rules:{username:[{required:!0,validator:({itemValue:e})=>{switch(!0){case!e:return new Error("请输入");case!e.trim():return new Error("空格无效")}}}],password:[{required:!0,validator:({itemValue:e})=>{switch(!0){case!e:return new Error("请输入");case!e.trim():return new Error("空格无效")}}}]}}),o=_({isUpdate:!0,commitQuery:()=>l.value?.commitProxy("query"),clearTable:()=>l.value?.reloadData([]),onShowModal:e=>{e?(o.isUpdate=!0,h.title="修改用户",i.data.username=e.username):(o.isUpdate=!1,h.title="新增用户");const t=i.items?.[0]?.itemRender?.props;t&&(t.disabled=o.isUpdate),v.value?.open(),I(()=>{!o.isUpdate&&p.value?.reset(),p.value?.clearValidate()})},onSubmitForm:()=>{i.loading||p.value?.validate(e=>{if(e)return;i.loading=!0;const t=()=>{i.loading=!1,v.value?.close(),D.success("操作成功"),!o.isUpdate&&o.afterInsert(),o.commitQuery()};o.isUpdate?setTimeout(()=>t(),1e3):setTimeout(()=>t(),1e3)})},afterInsert:()=>{const e=l.value?.getProxyInfo()?.pager;e&&e.currentPage*e.pageSize===e.total&&++e.currentPage},onDelete:e=>{const t=`确定 <strong style="color: var(--el-color-danger);"> 删除 </strong> 用户 <strong style="color: var(--el-color-primary);"> ${e.username} </strong> ？`,c={type:"warning",showClose:!0,closeOnClickModal:!0,closeOnPressEscape:!0,cancelButtonText:"取消",confirmButtonText:"确定",dangerouslyUseHTMLString:!0};S.confirm(t,"提示",c).then(()=>{E(e.id).then(()=>{D.success("删除成功"),o.afterDelete(),o.commitQuery()})})},afterDelete:()=>{const e=l.value.getData(),t=l.value?.getProxyInfo()?.pager;t&&t.currentPage>1&&e.length===1&&--t.currentPage},moreFn:()=>{}});return(e,t)=>{const c=R,m=y("vxe-button"),f=B,g=U,k=y("vxe-grid"),x=y("vxe-form"),M=y("vxe-modal");return V(),$("div",O,[r(c,{title:"数据来源",type:"success",description:"由 Apifox 提供在线 Mock，数据不具备真实性，仅供简单的 CRUD 操作演示","show-icon":""}),r(c,{title:"注意",type:"warning",description:"当前示例对应的 Vxe Table 版本最高兼容到 4.6.25","show-icon":""}),r(k,w({ref_key:"xGridDom",ref:l},u(b)),{"toolbar-btns":a(()=>[r(m,{status:"primary",icon:"vxe-icon-add",onClick:t[0]||(t[0]=n=>u(o).onShowModal())},{default:a(()=>[...t[1]||(t[1]=[d(" 新增用户 ",-1)])]),_:1}),r(m,{status:"danger",icon:"vxe-icon-delete"},{default:a(()=>[...t[2]||(t[2]=[d(" 批量删除 ",-1)])]),_:1})]),"role-column":a(({row:n,column:s})=>[r(f,{type:n[s.field]==="admin"?"primary":"warning",effect:"plain"},{default:a(()=>[d(T(n[s.field]),1)]),_:2},1032,["type"])]),"status-column":a(({row:n,column:s})=>[r(f,{type:n[s.field]?"success":"danger",effect:"plain"},{default:a(()=>[d(T(n[s.field]?"启用":"禁用"),1)]),_:2},1032,["type"])]),"row-operate":a(({row:n})=>[r(g,{link:"",type:"primary",onClick:s=>u(o).onShowModal(n)},{default:a(()=>[...t[3]||(t[3]=[d(" 修改 ",-1)])]),_:1},8,["onClick"]),r(g,{link:"",type:"danger",onClick:s=>u(o).onDelete(n)},{default:a(()=>[...t[4]||(t[4]=[d(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1},16),r(M,w({ref_key:"xModalDom",ref:v},u(h)),{default:a(()=>[r(x,w({ref_key:"xFormDom",ref:p},u(i)),null,16)]),_:1},16)])}}}),Z=G(q,[["__scopeId","data-v-2cc0057d"]]);export{Z as default};
