import"./index-C4l9wo9X.js";/* empty css                  *//* empty css               *//* empty css                 */import{g as E,d as P}from"./el-message-box-CWQjIyyx.js";/* empty css                 *//* empty css                   */import{ad as R,E as D,a3 as S,r as U,n as F}from"./element-CiAb6Vel.js";import{t as V,aF as w,V as v,n as B,v as I,M as r,E as a,z as C,u,ac as y,J as d,K as T,x as $}from"./vue-Cdw772MT.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vxe-DOrOiySX.js";const q={class:"app-container"},z=V({name:"VxeTable",__name:"index",setup(G){const l=w("xGridDom"),b=v({loading:!0,autoResize:!0,pagerConfig:{align:"right"},formConfig:{items:[{field:"username",itemRender:{name:"VxeInput",props:{placeholder:"用户名",clearable:!0}}},{field:"phone",itemRender:{name:"VxeInput",props:{placeholder:"手机号",clearable:!0}}},{itemRender:{name:"VxeButtonGroup",options:[{type:"submit",content:"查询",status:"primary",icon:"vxe-icon-search"},{type:"reset",content:"重置",icon:"vxe-icon-refresh"}]}}]},toolbarConfig:{refresh:!0,custom:!0,slots:{buttons:"toolbar-btns"}},customConfig:{checkMethod:({column:e})=>!["username"].includes(e.field)},columns:[{type:"checkbox",width:"50px"},{field:"username",title:"用户名"},{field:"roles",title:"角色",slots:{default:"role-column"}},{field:"phone",title:"手机号"},{field:"email",title:"邮箱"},{field:"status",title:"状态",slots:{default:"status-column"}},{field:"createTime",title:"创建时间"},{title:"操作",width:"150px",fixed:"right",showOverflow:!1,slots:{default:"row-operate"}}],proxyConfig:{seq:!0,form:!0,autoLoad:!0,props:{total:"total"},ajax:{query:({page:e,form:t})=>(b.loading=!0,o.clearTable(),new Promise(c=>{let m=0,f=[];const g=x=>{x?.data&&(m=x.data.total,f=x.data.list),b.loading=!1,c({total:m,result:f})},k={username:t.username||"",phone:t.phone||"",size:e.pageSize,currentPage:e.currentPage};E(k).then(g).catch(g)}))}}}),_=w("xModalDom"),h=v({title:"",showClose:!0,escClosable:!0,maskClosable:!0,beforeHideMethod:()=>(p.value?.clearValidate(),Promise.resolve())}),p=w("xFormDom"),i=v({span:24,titleWidth:"100px",loading:!1,titleColon:!1,data:{username:"",password:""},items:[{field:"username",title:"用户名",itemRender:{name:"$input",props:{placeholder:"请输入"}}},{field:"password",title:"密码",itemRender:{name:"$input",props:{placeholder:"请输入"}}},{align:"right",itemRender:{name:"$buttons",children:[{props:{content:"取消"},events:{click:()=>_.value?.close()}},{props:{type:"submit",content:"确定",status:"primary"},events:{click:()=>o.onSubmitForm()}}]}}],rules:{username:[{required:!0,validator:({itemValue:e})=>{switch(!0){case!e:return new Error("请输入");case!e.trim():return new Error("空格无效")}}}],password:[{required:!0,validator:({itemValue:e})=>{switch(!0){case!e:return new Error("请输入");case!e.trim():return new Error("空格无效")}}}]}}),o=v({isUpdate:!0,commitQuery:()=>l.value?.commitProxy("query"),clearTable:()=>l.value?.reloadData([]),onShowModal:e=>{e?(o.isUpdate=!0,h.title="修改用户",i.data.username=e.username):(o.isUpdate=!1,h.title="新增用户");const t=i.items?.[0]?.itemRender?.props;t&&(t.disabled=o.isUpdate),_.value?.open(),B(()=>{!o.isUpdate&&p.value?.reset(),p.value?.clearValidate()})},onSubmitForm:()=>{i.loading||p.value?.validate(e=>{if(e)return;i.loading=!0;const t=()=>{i.loading=!1,_.value?.close(),D.success("操作成功"),!o.isUpdate&&o.afterInsert(),o.commitQuery()};o.isUpdate?setTimeout(()=>t(),1e3):setTimeout(()=>t(),1e3)})},afterInsert:()=>{const e=l.value?.getProxyInfo()?.pager;e&&e.currentPage*e.pageSize===e.total&&++e.currentPage},onDelete:e=>{const t=`确定 <strong style="color: var(--el-color-danger);"> 删除 </strong> 用户 <strong style="color: var(--el-color-primary);"> ${e.username} </strong> ？`,c={type:"warning",showClose:!0,closeOnClickModal:!0,closeOnPressEscape:!0,cancelButtonText:"取消",confirmButtonText:"确定",dangerouslyUseHTMLString:!0};R.confirm(t,"提示",c).then(()=>{P(e.id).then(()=>{D.success("删除成功"),o.afterDelete(),o.commitQuery()})})},afterDelete:()=>{const e=l.value.getData(),t=l.value?.getProxyInfo()?.pager;t&&t.currentPage>1&&e.length===1&&--t.currentPage},moreFn:()=>{}});return(e,t)=>{const c=S,m=y("vxe-button"),f=F,g=U,k=y("vxe-grid"),x=y("vxe-form"),M=y("vxe-modal");return $(),I("div",q,[r(c,{title:"数据来源",type:"success",description:"由 Apifox 提供在线 Mock，数据不具备真实性，仅供简单的 CRUD 操作演示","show-icon":""}),r(c,{title:"注意",type:"warning",description:"当前示例对应的 Vxe Table 版本最高兼容到 4.6.25","show-icon":""}),r(k,C({ref_key:"xGridDom",ref:l},u(b)),{"toolbar-btns":a(()=>[r(m,{status:"primary",icon:"vxe-icon-add",onClick:t[0]||(t[0]=n=>u(o).onShowModal())},{default:a(()=>t[1]||(t[1]=[d(" 新增用户 ")])),_:1,__:[1]}),r(m,{status:"danger",icon:"vxe-icon-delete"},{default:a(()=>t[2]||(t[2]=[d(" 批量删除 ")])),_:1,__:[2]})]),"role-column":a(({row:n,column:s})=>[r(f,{type:n[s.field]==="admin"?"primary":"warning",effect:"plain"},{default:a(()=>[d(T(n[s.field]),1)]),_:2},1032,["type"])]),"status-column":a(({row:n,column:s})=>[r(f,{type:n[s.field]?"success":"danger",effect:"plain"},{default:a(()=>[d(T(n[s.field]?"启用":"禁用"),1)]),_:2},1032,["type"])]),"row-operate":a(({row:n})=>[r(g,{link:"",type:"primary",onClick:s=>u(o).onShowModal(n)},{default:a(()=>t[3]||(t[3]=[d(" 修改 ")])),_:2,__:[3]},1032,["onClick"]),r(g,{link:"",type:"danger",onClick:s=>u(o).onDelete(n)},{default:a(()=>t[4]||(t[4]=[d(" 删除 ")])),_:2,__:[4]},1032,["onClick"])]),_:1},16),r(M,C({ref_key:"xModalDom",ref:_},u(h)),{default:a(()=>[r(x,C({ref_key:"xFormDom",ref:p},u(i)),null,16)]),_:1},16)])}}}),Z=O(z,[["__scopeId","data-v-2cc0057d"]]);export{Z as default};
